<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Derivations · SmoQyDEAC.jl</title><meta name="title" content="Derivations · SmoQyDEAC.jl"/><meta property="og:title" content="Derivations · SmoQyDEAC.jl"/><meta property="twitter:title" content="Derivations · SmoQyDEAC.jl"/><meta name="description" content="Documentation for SmoQyDEAC.jl."/><meta property="og:description" content="Documentation for SmoQyDEAC.jl."/><meta property="twitter:description" content="Documentation for SmoQyDEAC.jl."/><meta property="og:url" content="https://SmoQySuite.github.io/SmoQyDEAC.jl/derivations/"/><meta property="twitter:url" content="https://SmoQySuite.github.io/SmoQyDEAC.jl/derivations/"/><link rel="canonical" href="https://SmoQySuite.github.io/SmoQyDEAC.jl/derivations/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">SmoQyDEAC.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../examples/fermion_greens/">Example 1: Fermion Greens function</a></li><li><a class="tocitem" href="../examples/SmoQyDQMC/">Example 2: Load from SmoQyDQMC and run SmoQyDEAC</a></li><li><a class="tocitem" href="../examples/user_mutation/">Example 3: User Mutation</a></li></ul></li><li class="is-active"><a class="tocitem" href>Derivations</a><ul class="internal"><li><a class="tocitem" href="#Periodicity"><span>Periodicity</span></a></li><li><a class="tocitem" href="#Reflection-Symmetry"><span>Reflection Symmetry</span></a></li><li><a class="tocitem" href="#Kernels-for-\\tau\\rightarrow\\omega"><span>Kernels for <span>$\tau\rightarrow\omega$</span></span></a></li><li><a class="tocitem" href="#Normalization"><span>Normalization</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Derivations</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Derivations</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SmoQySuite/SmoQyDEAC.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Derivations"><a class="docs-heading-anchor" href="#Derivations">Derivations</a><a id="Derivations-1"></a><a class="docs-heading-anchor-permalink" href="#Derivations" title="Permalink"></a></h1><p>Here we will derive properties of correlation functions in imaginary time and their spectral functions. If you find an error in this page please report an issue via github or email <a href="mailto:jneuhau1@utk.edu">James Neuhaus</a>. </p><p>Conventions: <span>$\hbar=1$</span>, for <span>$\pm,\mp$</span> top signs are for bosonic correlations, bottom signs fermionic</p><p>Causal Matsubara correlation functions are defined such that for operators <span>$\hat{A},\hat{B}$</span> the correlation function is </p><p class="math-container">\[C_{AB}(\tau -\tau&#39;)=-\langle T_{\tau}A(\tau)B(\tau&#39;)\rangle=-\Theta(\tau-\tau&#39;)\langle A(\tau)B(\tau&#39;)\rangle \mp \Theta(\tau&#39;-\tau)\langle B(\tau&#39;)A(\tau)\rangle \]</p><p>By using translational symmetry we can set <span>$\tau&#39;=0$</span> which we will do going forward.</p><h2 id="Periodicity"><a class="docs-heading-anchor" href="#Periodicity">Periodicity</a><a id="Periodicity-1"></a><a class="docs-heading-anchor-permalink" href="#Periodicity" title="Permalink"></a></h2><p>Starting from <span>$\tau &gt; 0$</span> we have</p><p class="math-container">\[\begin{align*}
C_{AB}\left(\tau&gt;0\right)=-\langle A\left(\tau\right)B\left(0\right)\rangle= &amp; -\frac{1}{Z}Tr\left[e^{-\beta H}e^{\tau H}Ae^{-\tau H}B\right]\\
= &amp; -\frac{1}{Z}Tr\left[Be^{-\beta H}e^{\tau H}Ae^{-\tau H}\right]\\
= &amp; -\frac{1}{Z}Tr\left[Be^{-\beta H}e^{\tau H}Ae^{-\tau H}\left(e^{\beta H}e^{-\beta H}\right)\right]\\
= &amp; -\frac{1}{Z}Tr\left[e^{-\beta H}Be^{-\beta H}e^{\tau H}Ae^{-\tau H}e^{\beta H}\right]\\
= &amp; -\frac{1}{Z}Tr\left[e^{-\beta H}Be^{\left(\tau-\beta\right)H}Ae^{-\left(\tau-\beta\right)H}\right]\\
= &amp; -\langle B\left(0\right)A\left(\tau-\beta\right)\rangle\\
= &amp; \pm\langle T_{\tau}A\left(\tau-\beta\right)B\left(0\right)\rangle\\
= &amp; \pm C_{AB}\left(\tau-\beta\right)
\end{align*}\]</p><p>Thus, correlation functions take on the patterns:</p><p><img src="../images/corr_sym.png" alt="Cristophe Berthod, https://giamarchi.unige.ch/wp-content/php\\_code/people/christophe.berthod/pdf/Many-body.pdf"/> <em><a href="https://giamarchi.unige.ch/wp-content/php_code/people/christophe.berthod/pdf/Many-body.pdf">Cristophe Berthod</a></em></p><h2 id="Reflection-Symmetry"><a class="docs-heading-anchor" href="#Reflection-Symmetry">Reflection Symmetry</a><a id="Reflection-Symmetry-1"></a><a class="docs-heading-anchor-permalink" href="#Reflection-Symmetry" title="Permalink"></a></h2><h3 id="Correlation-Functions"><a class="docs-heading-anchor" href="#Correlation-Functions">Correlation Functions</a><a id="Correlation-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Correlation-Functions" title="Permalink"></a></h3><p>Let us look at correlation functions with the operator order flipped</p><p class="math-container">\[\begin{align*}
C_{BA}\left(\tau\right)= &amp; -\Theta\left(\tau\right)\left\langle B\left(\tau\right)A\left(0\right)\right\rangle \mp\Theta\left(-\tau\right)\left\langle A\left(0\right)B\left(\tau\right)\right\rangle \\
= &amp; -\frac{\Theta\left(\tau\right)}{Z}Tr\left[e^{-\beta H}e^{\tau H}Be^{-\tau H}A\right]\mp\frac{\Theta\left(-\tau\right)}{Z}Tr\left[e^{-\beta H}Ae^{\tau H}Be^{-\tau H}\right]\\
= &amp; -\frac{\Theta\left(\tau\right)}{Z}Tr\left[e^{-\beta H}e^{\beta H}e^{-\tau H}Ae^{-\beta H}e^{\tau H}B\right]\mp\frac{\Theta\left(-\tau\right)}{Z}Tr\left[e^{-\beta H}Ae^{\tau H}e^{\beta H}e^{-\beta H}Be^{-\tau H}\right]\\
= &amp; -\frac{\Theta\left(\tau\right)}{Z}Tr\left[e^{-\beta H}e^{\beta H}e^{-\tau H}Ae^{-\beta H}e^{\tau H}B\right]\mp\frac{\Theta\left(-\tau\right)}{Z}Tr\left[e^{-\beta H}Be^{-\tau H}e^{-\beta H}Ae^{\tau H}e^{\beta H}\right]\\
= &amp; -\frac{\Theta\left(\tau\right)}{Z}Tr\left[e^{-\beta H}e^{\left(\beta-\tau\right)H}Ae^{-\left(\beta-\tau\right)H}e^{\tau H}B\right]\mp\frac{\Theta\left(-\tau\right)}{Z}Tr\left[e^{-\beta H}Be^{-\left(\beta+\tau\right)H}Ae^{\left(\beta+\tau\right)H}\right]\\
= &amp; -\Theta\left(\tau\right)\left\langle A\left(\beta-\tau\right)B\left(0\right)\right\rangle \mp\Theta\left(-\tau\right)\left\langle B\left(-\beta-\tau\right)A\left(0\right)\right\rangle \\
= &amp; \pm C_{AB}\left(\beta-\tau\right)
\end{align*}\]</p><p>It follows that in the case where the two operators are the same, <span>$B=A$</span>, this expression becomes <span>$C_{AA}\left(\tau\right)=\pm C_{AA}\left(\beta-\tau\right)$</span>. Thus, a symmetrized/antisymmetrized kernel is needed.</p><h3 id="Spectral-Functions"><a class="docs-heading-anchor" href="#Spectral-Functions">Spectral Functions</a><a id="Spectral-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Spectral-Functions" title="Permalink"></a></h3><p>We define our spectral function as</p><p class="math-container">\[\begin{align*}
\rho_{AB}\left(\omega\right)= &amp; \frac{2\pi}{Z}\left(1\mp e^{-\beta\omega}\right)\sum_{n,m}e^{-\beta E_{n}}\left\langle m\left|\hat{A}\right|n\right\rangle \left\langle n\left|\hat{B}\right|m\right\rangle \delta\left(\omega+E_{m}-E_{n}\right)
\end{align*}\]</p><p>We will swap indices and then take <span>$\omega\rightarrow -\omega$</span></p><p class="math-container">\[\begin{align*}
\rho_{AB}\left(\omega\right)= &amp; \frac{2\pi}{Z}\left(1\mp e^{-\beta\omega}\right)\sum_{n,m}e^{-\beta E_{n}}\left\langle m\left|\hat{A}\right|n\right\rangle \left\langle n\left|\hat{B}\right|m\right\rangle \delta\left(\omega+E_{m}-E_{n}\right)\\
= &amp; -\frac{2\pi}{Z}\left(1\mp e^{-\beta\omega}\right)\sum_{n,m}e^{-\beta E_{m}}\left\langle n\left|\hat{B}\right|m\right\rangle \left\langle m\left|\hat{A}\right|n\right\rangle \delta\left(\omega+E_{n}-E_{m}\right)\\
= &amp; -\rho_{BA}\left(-\omega\right)
\end{align*}\]</p><p>For both fermions and bosons we pick up a minus sign for two different reasons: bosons because of the inverted Bose factor <span>$1-e^{-\beta\omega}\rightarrow e^{-\beta\omega}-1$</span> and the fermion case&#39;s sign flips from the operator order flip. </p><p>In the case of <span>$A=B$</span> we get <span>$\rho(\omega)=-\rho(\omega)$</span></p><h2 id="Kernels-for-\\tau\\rightarrow\\omega"><a class="docs-heading-anchor" href="#Kernels-for-\\tau\\rightarrow\\omega">Kernels for <span>$\tau\rightarrow\omega$</span></a><a id="Kernels-for-\\tau\\rightarrow\\omega-1"></a><a class="docs-heading-anchor-permalink" href="#Kernels-for-\\tau\\rightarrow\\omega" title="Permalink"></a></h2><p>Spectral functions are defined in such a way as to reflect what is measured in experiment. For example, let&#39;s look at the correlation function which is also the electron Green&#39;s function</p><p class="math-container">\[\begin{align*}
G_{\alpha\beta}\left(\tau\right)= &amp; -\left\langle T_{\tau}a_{\alpha}\left(\tau\right)a_{\beta}^{\dagger}\left(0\right)\right\rangle 
\end{align*}\]</p><p>This relates back to the spectral function for the electron occupation energies through the relation</p><p class="math-container">\[\begin{align*}
G\left(\mathbf{k},\sigma,\tau&gt;0\right)= &amp; -\left\langle c_{\mathbf{k},\sigma}\left(\tau\right)c_{\mathbf{k},\sigma}^{\dagger}\left(0\right)\right\rangle \\
= &amp; -\frac{1}{Z}\sum_{n}\left\langle n\left|e^{-\beta H}e^{\tau H}c_{\mathbf{k},\sigma}e^{-\tau H}c_{\mathbf{k},\sigma}^{\dagger}\right|n\right\rangle \\
= &amp; -\frac{1}{Z}\sum_{n}e^{-\beta E_{n}}e^{\tau E_{n}}\left\langle n\left|c_{\mathbf{k},\sigma}e^{-\tau H}c_{\mathbf{k},\sigma}^{\dagger}\right|n\right\rangle \\
= &amp; -\frac{1}{Z}\sum_{m,n}e^{-\beta E_{n}}e^{\tau\left(E_{n}-E_{m}\right)}\left\langle n\left|c_{\mathbf{k},\sigma}\right|m\right\rangle \left\langle m\left|c_{\mathbf{k},\sigma}^{\dagger}\right|n\right\rangle \\
= &amp; -\frac{1}{Z}\sum_{m,n}e^{-\beta E_{n}}e^{\tau\left(E_{n}-E_{m}\right)}\left|\left\langle m\left|c_{\mathbf{k},\sigma}^{\dagger}\right|n\right\rangle \right|^{2}\\
= &amp; -\int_{-\infty}^{\infty}\frac{d\omega}{\pi}\frac{e^{-\omega\tau}}{1+e^{-\beta\omega}}\Im G\left(\mathbf{k},\sigma,\omega\right)\\
= &amp; \int_{-\infty}^{\infty} d\omega \frac{e^{-\omega\tau}}{1+e^{-\beta\omega}}A\left(\mathbf{k},\sigma,\omega\right)\\
\end{align*}\]</p><p>This gives us the fermionic kernel of <span>$\frac{e^{-\omega\tau}}{1+e^{-\beta\omega}}$</span>. Doing the same treatment for antisymmetric fermionic correlations, bosonic correlations, and symmetric bosonic correlations we get the following kernels:</p><p class="math-container">\[\begin{align*}
K_{fermion}\left(\omega,\tau\right)= &amp; \frac{e^{-\tau\omega}}{1+e^{-\beta\omega}}\\
K_{fermion,antisym}\left(\omega,\tau\right)= &amp; \frac{1}{2}\frac{e^{-\tau\omega}-e^{-\left(\beta-\tau\right)\omega}}{1+e^{-\beta\omega}}\\
K_{boson,asym}\left(\omega,\tau\right)= &amp; \frac{e^{-\tau\omega}}{1-e^{-\beta\omega}}\\
K_{boson,sym}\left(\omega,\tau\right)= &amp; \frac{e^{-\tau\omega}+e^{-\left(\beta-\tau\right)}}{1-e^{-\beta\omega}}
\end{align*}\]</p><h3 id="Bosonic-Kernel-Modifications-for-AC-methods"><a class="docs-heading-anchor" href="#Bosonic-Kernel-Modifications-for-AC-methods">Bosonic Kernel Modifications for AC methods</a><a id="Bosonic-Kernel-Modifications-for-AC-methods-1"></a><a class="docs-heading-anchor-permalink" href="#Bosonic-Kernel-Modifications-for-AC-methods" title="Permalink"></a></h3><p>For kernel functions odd about <span>$\omega=0$</span> most AC codes will pull a factor of <span>$\omega$</span> into the kernel. This makes the kernel analytic on the entire <span>$\omega$</span> line but AC will give you <span>$\frac{\rho(\omega)}{\omega}$</span>. Some codes will return this value. DEAC.jl handles this in the back end and reports only <span>$\rho(\omega)$</span>.</p><h2 id="Normalization"><a class="docs-heading-anchor" href="#Normalization">Normalization</a><a id="Normalization-1"></a><a class="docs-heading-anchor-permalink" href="#Normalization" title="Permalink"></a></h2><p>For the fermionic non-symmetric case it is simple to tell the zeroth moment of the spectral function</p><p class="math-container">\[\begin{align*}
C_{AB}\left(0\right)+C_{AB}\left(\beta\right)= &amp; \int d\omega A\left(\omega\right)\frac{e^{-0\omega}+e^{-\beta\omega}}{1+e^{-\beta\omega}}\\
C_{AB}\left(0\right)+C_{AB}\left(\beta\right)= &amp; \int d\omega A\left(\omega\right)
\end{align*}\]</p><p>For any others there is no obvious way to derive the zeroth moment. </p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../examples/user_mutation/">« Example 3: User Mutation</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Thursday 18 January 2024 16:52">Thursday 18 January 2024</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
